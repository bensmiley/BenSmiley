// Generated by CoffeeScript 1.7.1
var __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

define(['app', 'text!apps/user-domains/templates/AddEditUserDomain.html'], function(App, addEditUserDomainTpl) {
  var UserDomainAddEditView;
  UserDomainAddEditView = (function(_super) {
    __extends(UserDomainAddEditView, _super);

    function UserDomainAddEditView() {
      return UserDomainAddEditView.__super__.constructor.apply(this, arguments);
    }

    UserDomainAddEditView.prototype.className = 'add-user-domain-container';

    UserDomainAddEditView.prototype.template = addEditUserDomainTpl;

    UserDomainAddEditView.prototype.events = {
      'click #btn-add-edit-user-domain': function() {
        var domaindata;
        if (this.$el.find('#add-edit-user-domain-form').valid()) {
          domaindata = Backbone.Syphon.serialize(this);
          return this.trigger("add:edit:user:domain:clicked", domaindata);
        }
      },
      'click #show-domain-list': function() {
        return this.trigger("show:domain:list:clicked");
      }
    };

    UserDomainAddEditView.prototype.regions = {
      addDomainGroupRegion: '#add-domain-group'
    };

    UserDomainAddEditView.prototype.onShow = function() {
      if (_.isUndefined(this.model)) {
        this.$el.find('#form-title').text('Add Domain');
      } else {
        this.$el.find('#form-title').text('Edit Domain');
        this.$el.find('#domain-groups').css({
          'display': 'inline'
        });
      }
      return this.$el.find('#add-edit-user-domain-form').validate(this.validationOptions());
    };

    UserDomainAddEditView.prototype.onUserDomainAddUpdate = function() {
      var msg, successhtml;
      this.$el.find('#btn-reset-add-domain').click();
      this.$el.find('#msg').empty();
      if (_.isUndefined(this.model)) {
        msg = "Domain Sucessfully Added";
      } else {
        msg = "Domain Updated Sucessfully";
      }
      successhtml = "<div class='alert alert-success'> <button class='close' data-dismiss='alert'>&times;</button>" + msg + "<div>";
      return this.$el.find('#msg').append(successhtml);
    };

    UserDomainAddEditView.prototype.validationOptions = function() {
      return {
        rules: {
          post_title: {
            required: true
          },
          domain_url: {
            required: true,
            url: true
          }
        },
        messages: {
          domain_url: 'Enter valid url'
        }
      };
    };

    return UserDomainAddEditView;

  })(Marionette.Layout);
  return UserDomainAddEditView;
});
